<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="bwrob">
<meta name="dcterms.date" content="2024-05-21">
<meta name="description" content="Start your day with a cup of coffee, not opening the same apps all over again every morning.">

<title>Python Startup Script – bwrob blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../logo/python_mug.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="bwrob blog">
<meta property="og:description" content="bwrob personal and professional blog">
<meta property="og:image" content="https://bwrob.github.io/posts/startup_script/win_98.png">
<meta property="og:site_name" content="bwrob blog">
<meta property="og:image:height" content="1037">
<meta property="og:image:width" content="1038">
<meta name="twitter:title" content="bwrob blog">
<meta name="twitter:description" content="bwrob personal and professional blog">
<meta name="twitter:image" content="https://bwrob.github.io/posts/startup_script/win_98.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image-height" content="1037">
<meta name="twitter:image-width" content="1038">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../logo/python_mug.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">bwrob blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> <i class="bi bi-cpu" role="img">
</i> 
<span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../pages/resume.html"> <i class="bi bi-file-earmark-text" role="img">
</i> 
<span class="menu-text">Resume</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../pages/hobbies.html"> <i class="bi bi-controller" role="img">
</i> 
<span class="menu-text">Hobbies</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/bartoszmwroblewski/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/bwrob/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Python Startup Script</h1>
                  <div>
        <div class="description">
          Start your day with a cup of coffee, not opening the same apps all over again every morning.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Pythonic Distractions</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>bwrob </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 21, 2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">August 17, 2024</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#why-a-startup-script" id="toc-why-a-startup-script" class="nav-link active" data-scroll-target="#why-a-startup-script">Why a startup script?</a></li>
  <li><a href="#the-startup-script" id="toc-the-startup-script" class="nav-link" data-scroll-target="#the-startup-script">The startup script</a>
  <ul class="collapse">
  <li><a href="#public-interface" id="toc-public-interface" class="nav-link" data-scroll-target="#public-interface">Public interface</a></li>
  <li><a href="#decorator-defaulting-the-time-delays" id="toc-decorator-defaulting-the-time-delays" class="nav-link" data-scroll-target="#decorator-defaulting-the-time-delays">Decorator defaulting the time delays</a></li>
  <li><a href="#main-workers" id="toc-main-workers" class="nav-link" data-scroll-target="#main-workers">Main workers</a></li>
  <li><a href="#list-all-files-in-list-of-directories" id="toc-list-all-files-in-list-of-directories" class="nav-link" data-scroll-target="#list-all-files-in-list-of-directories">List all files in list of directories</a></li>
  <li><a href="#interacting-with-the-os" id="toc-interacting-with-the-os" class="nav-link" data-scroll-target="#interacting-with-the-os">Interacting with the OS</a></li>
  </ul></li>
  <li><a href="#the-last-bit-of-convenience" id="toc-the-last-bit-of-convenience" class="nav-link" data-scroll-target="#the-last-bit-of-convenience">The last bit of convenience</a></li>
  <li><a href="#further-extensions" id="toc-further-extensions" class="nav-link" data-scroll-target="#further-extensions">Further extensions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="win_98.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:65.0%"></p>
</figure>
</div>
<section id="why-a-startup-script" class="level2">
<h2 class="anchored" data-anchor-id="why-a-startup-script">Why a startup script?</h2>
<p>Confession time. Pre-COVID I worked for a Swiss bank — it was the whole corporate package. Working from a crowded office, open space, dedicated desks, dedicated desktop PCs, hundreds of people. And we never turned the PCs off, some of them were running constantly for months. Not very eco-friendly behaviour, either from the company side or from the employees. But there were legit reasons for this and the company had much <a href="https://www.wikiwand.com/en/Credit_Suisse#Controversies">bigger sins</a> on their books.</p>
<p>As for the reasons for constantly turned on machines — the proprietary frameworks and tooling we used were awfully heavy and slow. If you were occasionally forced to kill all the processes — due to an update or system crash — getting them all up again took an hour or more. Developer tools, pricing systems, connections to Monte Carlo farms, downloading trade data, analysis definitions — you name it, we used it.</p>
<p>One tidbit to get this point across — in 2019 we still used 32-bit Win7, which had a cap on single-process memory consumption to 4GB. We had a universally used hack to extend this to 8GB for Excel, since the default wasn’t enough for many of our pricing sheets.</p>
<p>When I parted ways with the company post-COVID, I got a corporate laptop from the new employer. The office was much sparser, quieter and with ‘hot seats’ approach. I worked mostly remotely either way. This meant switching off the company machine each day, as the VPN connections and certificates wouldn’t last overnight. I was extremely annoyed with opening all of the daily tools again and again, after getting used to having it all waiting for me to jump right in.</p>
<p>Hence the need for a startup script to open all of the apps, tools and files programatically. It won’t cover everything, like authorizations or connections but still a little helper to start the day.</p>
<p>To spice things up, we will overengineer the hell out of it and use generic typing, generators and decorators :D.</p>
</section>
<section id="the-startup-script" class="level2">
<h2 class="anchored" data-anchor-id="the-startup-script">The startup script</h2>
<section id="public-interface" class="level3">
<h3 class="anchored" data-anchor-id="public-interface">Public interface</h3>
<p>Let’s first think about the design and what we want to achieve. Imagine the code being split into two parts:</p>
<ul>
<li>the hidden logic layer, <strong>the worker</strong> that does stuff and</li>
<li>the public interface that integrates with the rest of the codebase or is called at the top level, <strong>the manager</strong>.</li>
</ul>
<p>We can start by creating the public interface, see what we want to achieve and later deal with filling in a working implementation. You can either define the logic functions as mocks, or just live with linting issues. This is what my desired usage is:</p>
<div id="0b794c7d" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">def</span> run_startup_script() <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb1-2"><a href="#cb1-2"></a>    <span class="co">"""Run the startup script."""</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>    logger.info(<span class="ss">f" Welcome </span><span class="sc">{</span>os<span class="sc">.</span>getlogin()<span class="sc">}</span><span class="ss">! "</span>.center(<span class="dv">40</span>, <span class="st">"*"</span>))</span>
<span id="cb1-4"><a href="#cb1-4"></a>    start_programs(</span>
<span id="cb1-5"><a href="#cb1-5"></a>        [</span>
<span id="cb1-6"><a href="#cb1-6"></a>            Program.POWERSHELL,</span>
<span id="cb1-7"><a href="#cb1-7"></a>            Program.NOTEPAD,</span>
<span id="cb1-8"><a href="#cb1-8"></a>            (Program.FIREFOX, <span class="dv">8</span>),</span>
<span id="cb1-9"><a href="#cb1-9"></a>        ],</span>
<span id="cb1-10"><a href="#cb1-10"></a>    )</span>
<span id="cb1-11"><a href="#cb1-11"></a>    start_work_files([Path.home() <span class="op">/</span> <span class="st">".temp"</span>])</span>
<span id="cb1-12"><a href="#cb1-12"></a>    run_commands([<span class="st">'Write-Output "test"'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We specify programs to be launched, open all files in a chosen temp folder and run a list of shell commands. After each step there should be some delay to avoid spamming system with process calls. Certain steps might be more time consuming, like cloud services authorization. Those need longer delay. On the other hand, specifying delay for each task would be cumbersome, most cases would be fine with some default value. We end up with a design that our soon-to-be workers <code>start_programs</code>, <code>start_work_files</code>, and <code>run_commands</code> expect lists of either <code>task</code> or <code>(task, delay_seconds)</code>. We can now start the implementation by figuring out how the delay time should be defaulted if not specified.</p>
</section>
<section id="decorator-defaulting-the-time-delays" class="level3">
<h3 class="anchored" data-anchor-id="decorator-defaulting-the-time-delays">Decorator defaulting the time delays</h3>
<p>Now we can start the implementation. We want the workers to be called with a list of tasks, but a task can be either a command or a tuple including the delay. Let’s not include some complicated conditionals in each of the workers — that would be annoying and potentially get out of sync at some point.</p>
<p>Other way to do this is to add a default delay to all non-tuple items. We can implement that as a separate defaulting function, which we would call in each worker. But — being more clever! — we could also use a decorator that changes the workers’s signature.</p>
<div id="101feaa4" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">from</span> functools <span class="im">import</span> wraps</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="im">from</span> collections.abc <span class="im">import</span> Callable</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="im">from</span> typing <span class="im">import</span> TypeVar</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a>T <span class="op">=</span> TypeVar(<span class="st">"T"</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a>Task <span class="op">=</span> <span class="bu">tuple</span>[T, <span class="bu">int</span>]</span>
<span id="cb2-7"><a href="#cb2-7"></a>TaskList <span class="op">=</span> <span class="bu">list</span>[Task[T]]</span>
<span id="cb2-8"><a href="#cb2-8"></a>TaskListOptionalDelay <span class="op">=</span> <span class="bu">list</span>[Task[T] <span class="op">|</span> T]</span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a></span>
<span id="cb2-11"><a href="#cb2-11"></a>DEFAULT_DELAY_SECONDS <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="kw">def</span> with_optional_delay(</span>
<span id="cb2-14"><a href="#cb2-14"></a>    task_worker: Callable[[TaskList[T]], <span class="va">None</span>],</span>
<span id="cb2-15"><a href="#cb2-15"></a>) <span class="op">-&gt;</span> Callable[[TaskListOptionalDelay[T]], <span class="va">None</span>]:</span>
<span id="cb2-16"><a href="#cb2-16"></a>    <span class="co">"""Add default delay to all non-tuple items.</span></span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co">    Args:</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co">    ----</span></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="co">        task_worker: A function that takes a list of tasks.</span></span>
<span id="cb2-21"><a href="#cb2-21"></a></span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="co">    """</span></span>
<span id="cb2-23"><a href="#cb2-23"></a></span>
<span id="cb2-24"><a href="#cb2-24"></a>    <span class="at">@wraps</span>(task_worker)</span>
<span id="cb2-25"><a href="#cb2-25"></a>    <span class="kw">def</span> task_defaulted_worker(task_list: TaskListOptionalDelay[T]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb2-26"><a href="#cb2-26"></a>        <span class="co">"""Add a default delay to tasks in a task list if no delay is specified.</span></span>
<span id="cb2-27"><a href="#cb2-27"></a></span>
<span id="cb2-28"><a href="#cb2-28"></a><span class="co">        Args:</span></span>
<span id="cb2-29"><a href="#cb2-29"></a><span class="co">        ----</span></span>
<span id="cb2-30"><a href="#cb2-30"></a><span class="co">            task_list: A list of tasks with optional delays.</span></span>
<span id="cb2-31"><a href="#cb2-31"></a></span>
<span id="cb2-32"><a href="#cb2-32"></a><span class="co">        """</span></span>
<span id="cb2-33"><a href="#cb2-33"></a>        tasks_with_defaulted_delays: TaskList[T] <span class="op">=</span> [</span>
<span id="cb2-34"><a href="#cb2-34"></a>            item <span class="cf">if</span> <span class="bu">isinstance</span>(item, <span class="bu">tuple</span>) <span class="cf">else</span> (item, DEFAULT_DELAY_SECONDS)</span>
<span id="cb2-35"><a href="#cb2-35"></a>            <span class="cf">for</span> item <span class="kw">in</span> task_list</span>
<span id="cb2-36"><a href="#cb2-36"></a>        ]</span>
<span id="cb2-37"><a href="#cb2-37"></a>        <span class="cf">return</span> task_worker(tasks_with_defaulted_delays)</span>
<span id="cb2-38"><a href="#cb2-38"></a></span>
<span id="cb2-39"><a href="#cb2-39"></a>    <span class="cf">return</span> task_defaulted_worker</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First, for convenience, let’s define a template type annotation:</p>
<ul>
<li>The generic variable type is conventionally denoted by <code>T</code>.</li>
<li>A <code>Task</code> is a tuple of a generic task <code>T</code> and an <code>int</code> delay.</li>
<li>A <code>TaskList</code> is a list of <code>Task</code>s. Simple.</li>
<li>A <code>TaskListOptionalDelay</code> is a list of <code>Task</code>s or <code>T</code>s. Those are the guys we are going to turn into <code>TaskLists</code>.</li>
</ul>
<p>The decorator <code>with_optional_delay</code> adds a default delay of 4 seconds to all non-tuple items. Its input is a worker function that already expects a <code>TaskList</code>. It fills in the missing delay with the default value and passes it to the decorated function.</p>
</section>
<section id="main-workers" class="level3">
<h3 class="anchored" data-anchor-id="main-workers">Main workers</h3>
<p>With the preparation done, we can start with the workers. For the programs we will be launching, we need to look up the exact paths of the executables. Let’s define a <code>Program</code> enum that would wrap those up in readable nice names. For working with system paths we will use <code>pathlib.Path</code> that provides high-level interface.</p>
<div id="36e145b9" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">from</span> enum <span class="im">import</span> Enum</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="kw">class</span> Program(Enum):</span>
<span id="cb3-6"><a href="#cb3-6"></a>    <span class="co">"""Types of programs."""</span></span>
<span id="cb3-7"><a href="#cb3-7"></a></span>
<span id="cb3-8"><a href="#cb3-8"></a>    POWERSHELL <span class="op">=</span> Path(<span class="vs">r"C:\windows\system32\windowspowershell\v1.0\powershell.exe"</span>)</span>
<span id="cb3-9"><a href="#cb3-9"></a>    NOTEPAD <span class="op">=</span> Path(<span class="vs">r"C:\Program Files\Notepad++\notepad++.exe"</span>)</span>
<span id="cb3-10"><a href="#cb3-10"></a>    FIREFOX <span class="op">=</span> Path(<span class="vs">r"C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Firefox.lnk"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Other than that, the main workers <code>start_programs</code>, <code>start_work_files</code>, and <code>run_commands</code> are simple. They just iterate over the provided <code>TaskList</code> and do the respective action for a given <code>Task</code>.</p>
<div id="6152ba75" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="at">@with_optional_delay</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw">def</span> start_programs(</span>
<span id="cb4-3"><a href="#cb4-3"></a>    programs: TaskList[Program],</span>
<span id="cb4-4"><a href="#cb4-4"></a>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb4-5"><a href="#cb4-5"></a>    <span class="co">"""Start listed programs.</span></span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">    Args:</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">    ----</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">        programs: List of programs to start.</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">            Can be a string or a tuple. If a tuple is given, the first</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">            element is the name, the second is the delay.</span></span>
<span id="cb4-12"><a href="#cb4-12"></a></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">    """</span></span>
<span id="cb4-14"><a href="#cb4-14"></a>    <span class="cf">for</span> program, delay <span class="kw">in</span> programs:</span>
<span id="cb4-15"><a href="#cb4-15"></a>        start_process(</span>
<span id="cb4-16"><a href="#cb4-16"></a>            name<span class="op">=</span>program.name,</span>
<span id="cb4-17"><a href="#cb4-17"></a>            path<span class="op">=</span>program.value,</span>
<span id="cb4-18"><a href="#cb4-18"></a>            delay<span class="op">=</span>delay,</span>
<span id="cb4-19"><a href="#cb4-19"></a>        )</span>
<span id="cb4-20"><a href="#cb4-20"></a></span>
<span id="cb4-21"><a href="#cb4-21"></a></span>
<span id="cb4-22"><a href="#cb4-22"></a><span class="at">@with_optional_delay</span></span>
<span id="cb4-23"><a href="#cb4-23"></a><span class="kw">def</span> start_work_files(</span>
<span id="cb4-24"><a href="#cb4-24"></a>    directory_tasks: TaskList[Path],</span>
<span id="cb4-25"><a href="#cb4-25"></a>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb4-26"><a href="#cb4-26"></a>    <span class="co">"""Start all  files in the work folders.</span></span>
<span id="cb4-27"><a href="#cb4-27"></a></span>
<span id="cb4-28"><a href="#cb4-28"></a><span class="co">    Args:</span></span>
<span id="cb4-29"><a href="#cb4-29"></a><span class="co">    ----</span></span>
<span id="cb4-30"><a href="#cb4-30"></a><span class="co">        directory_tasks: List of tasks with paths to work folders.</span></span>
<span id="cb4-31"><a href="#cb4-31"></a></span>
<span id="cb4-32"><a href="#cb4-32"></a><span class="co">    """</span></span>
<span id="cb4-33"><a href="#cb4-33"></a>    <span class="cf">for</span> path, delay <span class="kw">in</span> path_files(directory_tasks):</span>
<span id="cb4-34"><a href="#cb4-34"></a>        start_process(</span>
<span id="cb4-35"><a href="#cb4-35"></a>            name<span class="op">=</span>path.name,</span>
<span id="cb4-36"><a href="#cb4-36"></a>            path<span class="op">=</span>path,</span>
<span id="cb4-37"><a href="#cb4-37"></a>            delay<span class="op">=</span>delay,</span>
<span id="cb4-38"><a href="#cb4-38"></a>        )</span>
<span id="cb4-39"><a href="#cb4-39"></a></span>
<span id="cb4-40"><a href="#cb4-40"></a></span>
<span id="cb4-41"><a href="#cb4-41"></a><span class="at">@with_optional_delay</span></span>
<span id="cb4-42"><a href="#cb4-42"></a><span class="kw">def</span> run_commands(</span>
<span id="cb4-43"><a href="#cb4-43"></a>    commands: TaskList[<span class="bu">str</span>],</span>
<span id="cb4-44"><a href="#cb4-44"></a>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb4-45"><a href="#cb4-45"></a>    <span class="co">"""Run all commands in the command list.</span></span>
<span id="cb4-46"><a href="#cb4-46"></a></span>
<span id="cb4-47"><a href="#cb4-47"></a><span class="co">    Args:</span></span>
<span id="cb4-48"><a href="#cb4-48"></a><span class="co">    ----</span></span>
<span id="cb4-49"><a href="#cb4-49"></a><span class="co">        commands: List of commands to run.</span></span>
<span id="cb4-50"><a href="#cb4-50"></a></span>
<span id="cb4-51"><a href="#cb4-51"></a><span class="co">    """</span></span>
<span id="cb4-52"><a href="#cb4-52"></a>    <span class="cf">for</span> command, delay <span class="kw">in</span> commands:</span>
<span id="cb4-53"><a href="#cb4-53"></a>        run_command(command, delay)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="list-all-files-in-list-of-directories" class="level3">
<h3 class="anchored" data-anchor-id="list-all-files-in-list-of-directories">List all files in list of directories</h3>
<p>Notice the use of <code>path_files</code> generator above. When working with complex iterations, it’s a good practice to create a generator that wraps the iteration details. It is beneficial for readability and maintainability, especially in cases where you need to:</p>
<ul>
<li>yield multiple values at once (ex. <em>yield path, delay for path in directory</em>),</li>
<li>have nested iterators (ex. <em>for directory in list for path in directory</em>),</li>
<li>filter the iteration (ex. <em>for path in directory if filter(path)</em>).</li>
</ul>
<p>Here we’ll have all three of them combined!</p>
<div id="17fd406b" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>NAME_EXCLUDES <span class="op">=</span> (<span class="st">"$"</span>, <span class="st">"tmp"</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>EXT_EXCLUDES <span class="op">=</span> (<span class="st">"exe"</span>,)</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="kw">def</span> filter_excluded(</span>
<span id="cb5-6"><a href="#cb5-6"></a>    path: Path,</span>
<span id="cb5-7"><a href="#cb5-7"></a>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb5-8"><a href="#cb5-8"></a>    <span class="co">"""Filter path based on name and extension exclude lists.</span></span>
<span id="cb5-9"><a href="#cb5-9"></a></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">    Args:</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">    ----</span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">        path: Path to filter.</span></span>
<span id="cb5-13"><a href="#cb5-13"></a></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co">    """</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>    <span class="cf">return</span> (path.stem <span class="kw">not</span> <span class="kw">in</span> NAME_EXCLUDES) <span class="kw">and</span> (path.suffix <span class="kw">not</span> <span class="kw">in</span> EXT_EXCLUDES)</span>
<span id="cb5-16"><a href="#cb5-16"></a></span>
<span id="cb5-17"><a href="#cb5-17"></a></span>
<span id="cb5-18"><a href="#cb5-18"></a></span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="kw">def</span> path_files(</span>
<span id="cb5-20"><a href="#cb5-20"></a>    directory_tasks: TaskList[Path],</span>
<span id="cb5-21"><a href="#cb5-21"></a>) <span class="op">-&gt;</span> Generator[<span class="bu">tuple</span>[Path, <span class="bu">int</span>], <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb5-22"><a href="#cb5-22"></a>    <span class="co">"""Generate all files in the work folder that are not excluded.</span></span>
<span id="cb5-23"><a href="#cb5-23"></a></span>
<span id="cb5-24"><a href="#cb5-24"></a><span class="co">    Yields the folder path at beginning of the generator.</span></span>
<span id="cb5-25"><a href="#cb5-25"></a></span>
<span id="cb5-26"><a href="#cb5-26"></a><span class="co">    Args:</span></span>
<span id="cb5-27"><a href="#cb5-27"></a><span class="co">    ----</span></span>
<span id="cb5-28"><a href="#cb5-28"></a><span class="co">        directory_tasks: List of tasks with paths to work folders.</span></span>
<span id="cb5-29"><a href="#cb5-29"></a></span>
<span id="cb5-30"><a href="#cb5-30"></a><span class="co">    """</span></span>
<span id="cb5-31"><a href="#cb5-31"></a>    <span class="cf">for</span> folder, delay <span class="kw">in</span> directory_tasks:</span>
<span id="cb5-32"><a href="#cb5-32"></a>        <span class="cf">yield</span> folder, delay</span>
<span id="cb5-33"><a href="#cb5-33"></a></span>
<span id="cb5-34"><a href="#cb5-34"></a>        all_files <span class="op">=</span> folder.glob(FILES_IN_TREE_PATTERN)</span>
<span id="cb5-35"><a href="#cb5-35"></a>        filtered <span class="op">=</span> <span class="bu">filter</span>(filter_excluded, all_files)</span>
<span id="cb5-36"><a href="#cb5-36"></a></span>
<span id="cb5-37"><a href="#cb5-37"></a>        <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> filtered:</span>
<span id="cb5-38"><a href="#cb5-38"></a>            <span class="cf">yield</span> <span class="bu">file</span>, delay</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>filter_excluded</code> function filters out files based on exclusions in name and extension lists. <code>Path.stem</code> and <code>Path.suffix</code> are used to check if the file name or extension is in the lists respectively.</p>
</section>
<section id="interacting-with-the-os" class="level3">
<h3 class="anchored" data-anchor-id="interacting-with-the-os">Interacting with the OS</h3>
<p>With all of the framework prepared, the next step is to interact with the OS. To open a file, folder or run an app, we can use the <code>os.startfile</code> function. All the rest of the <code>start_process</code> function is just utility logging. For running a shell command we can use the <code>subprocess</code> module, calling powershell with the <code>powershell.exe</code> and adding the command to run.</p>
<div id="2b4f68a0" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="im">import</span> os</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="im">import</span> subprocess</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="im">import</span> time</span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="kw">def</span> start_process(</span>
<span id="cb6-7"><a href="#cb6-7"></a>    <span class="op">*</span>,</span>
<span id="cb6-8"><a href="#cb6-8"></a>    name: <span class="bu">str</span>,</span>
<span id="cb6-9"><a href="#cb6-9"></a>    path: Path,</span>
<span id="cb6-10"><a href="#cb6-10"></a>    delay: <span class="bu">int</span> <span class="op">=</span> DEFAULT_DELAY_SECONDS,</span>
<span id="cb6-11"><a href="#cb6-11"></a>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb6-12"><a href="#cb6-12"></a>    <span class="co">"""Given a path, starts the target.</span></span>
<span id="cb6-13"><a href="#cb6-13"></a></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co">    Behavior:</span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co">        * Minimizes all windows.</span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co">        * Depending on the path target:</span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co">            * executable files are run,</span></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co">            * content files are opened with system default program,</span></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co">            * folders are opened with system explorer.</span></span>
<span id="cb6-20"><a href="#cb6-20"></a></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="co">    Args:</span></span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="co">    ----</span></span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="co">        name: Name of the process to start.</span></span>
<span id="cb6-24"><a href="#cb6-24"></a><span class="co">        path: Path to the target.</span></span>
<span id="cb6-25"><a href="#cb6-25"></a><span class="co">        delay: Time to wait after starting the process.</span></span>
<span id="cb6-26"><a href="#cb6-26"></a></span>
<span id="cb6-27"><a href="#cb6-27"></a><span class="co">    """</span></span>
<span id="cb6-28"><a href="#cb6-28"></a>    <span class="cf">if</span> path.is_dir():</span>
<span id="cb6-29"><a href="#cb6-29"></a>        logger.info(<span class="st">"Opening folder </span><span class="sc">%s</span><span class="st">"</span>, name)</span>
<span id="cb6-30"><a href="#cb6-30"></a></span>
<span id="cb6-31"><a href="#cb6-31"></a>    <span class="cf">if</span> path.suffix <span class="kw">in</span> (<span class="st">".exe"</span>, <span class="st">".lnk"</span>):</span>
<span id="cb6-32"><a href="#cb6-32"></a>        logger.info(<span class="st">"Running app </span><span class="sc">%s</span><span class="st">"</span>, name)</span>
<span id="cb6-33"><a href="#cb6-33"></a>    <span class="cf">else</span>:</span>
<span id="cb6-34"><a href="#cb6-34"></a>        logger.info(<span class="st">"Opening file </span><span class="sc">%s</span><span class="st">"</span>, name)</span>
<span id="cb6-35"><a href="#cb6-35"></a></span>
<span id="cb6-36"><a href="#cb6-36"></a>    os.startfile(path)</span>
<span id="cb6-37"><a href="#cb6-37"></a>    time.sleep(delay)</span>
<span id="cb6-38"><a href="#cb6-38"></a></span>
<span id="cb6-39"><a href="#cb6-39"></a></span>
<span id="cb6-40"><a href="#cb6-40"></a><span class="kw">def</span> run_command(</span>
<span id="cb6-41"><a href="#cb6-41"></a>    command: <span class="bu">str</span>,</span>
<span id="cb6-42"><a href="#cb6-42"></a>    delay: <span class="bu">int</span>,</span>
<span id="cb6-43"><a href="#cb6-43"></a>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb6-44"><a href="#cb6-44"></a>    <span class="co">"""Run a powershell command.</span></span>
<span id="cb6-45"><a href="#cb6-45"></a></span>
<span id="cb6-46"><a href="#cb6-46"></a><span class="co">    Args:</span></span>
<span id="cb6-47"><a href="#cb6-47"></a><span class="co">    ----</span></span>
<span id="cb6-48"><a href="#cb6-48"></a><span class="co">        command: Command to run.</span></span>
<span id="cb6-49"><a href="#cb6-49"></a><span class="co">        delay: Time to wait after starting the process.</span></span>
<span id="cb6-50"><a href="#cb6-50"></a></span>
<span id="cb6-51"><a href="#cb6-51"></a><span class="co">    """</span></span>
<span id="cb6-52"><a href="#cb6-52"></a>    _ <span class="op">=</span> subprocess.call(</span>
<span id="cb6-53"><a href="#cb6-53"></a>        <span class="ss">f"powershell.exe </span><span class="sc">{</span>command<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb6-54"><a href="#cb6-54"></a>        shell<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb6-55"><a href="#cb6-55"></a>    )</span>
<span id="cb6-56"><a href="#cb6-56"></a>    time.sleep(delay)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="the-last-bit-of-convenience" class="level2">
<h2 class="anchored" data-anchor-id="the-last-bit-of-convenience">The last bit of convenience</h2>
<p>We got it, friends, the script works and the job is done. But… do you recall the last time you googled a shortcut for a semi-frequently used functionality? Do you still remember the shortcut, or use it each time you need the functionality? Convenience needs to be convenient (obviously). So let’s make the usage of our script as seamless as possible.</p>
<p>In Windows OS the best way for me would be to have a shortcut that would run it with one click. We could pin it to the taskbar and start menu. To create one:</p>
<ul>
<li>Go to any folder, right-click and select <code>New &gt; Shortcut</code>.</li>
<li>In the guide that pops up paste in <code>%systemroot%\System32\cmd.exe /c "python.exe $1"</code> where <code>$1</code> should be replaced by the path to your script. You can also replace <code>python.exe</code> with interpreter path of any venv you wish.</li>
<li>Optionally, you can later change the icon for the shortcut (needs to be <code>.ico</code> file). I like to roll with Win-98 style ‘My Computer’ icon.</li>
<li>Copy the shortcut to start menu directory. For Win11 it’s <code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs</code>. You should be able to see it in start menu already. Now you can pin it to the taskbar.</li>
</ul>
<p><img src="startup_shortcut.png" class="img-fluid" style="width:100.0%"></p>
<p>That’s a good enough reminder and convenience tool for me. You might need some different setup, especially for another OS. For Linux, you might try to leverage <code>activate</code> or <code>bashrc</code> scripts in your working setup.</p>
</section>
<section id="further-extensions" class="level2">
<h2 class="anchored" data-anchor-id="further-extensions">Further extensions</h2>
<p>There are a couple more things I wish this guy could do for me still:</p>
<ul>
<li><strong>Changing Teams status to green</strong> - there’s a MS Graph API that could do this but we would need to manage Azure authorizations through the script. I am not up to that, especially on a work account. Might experiment on personal one in the future.</li>
<li><strong>Display placement of opened processes</strong> — I have 2 displays (which you could count as 4, due to the size format) and I am very particular about where each app should go. I would love the apps to open where they should. This is however OS specific, for Win it require to mingle with win32api. Yet another project for the future.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Download the startup <a href="../../scripts/startup_script.py">script</a> and example Windows <a href="Startup!.lnk">shortcut</a>.</p>
</div>
</div>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/bwrob\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2024, bwrob</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>